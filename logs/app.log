INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5014
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug: * Restarting with stat
WARNING:werkzeug: * Debugger is active!
INFO:werkzeug: * Debugger PIN: 380-840-231
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5014
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug: * Restarting with stat
WARNING:werkzeug: * Debugger is active!
INFO:werkzeug: * Debugger PIN: 380-840-231
INFO:root:File received is Multiple-Dataflows.dtsx
INFO:root:File saved in temp library
INFO:root:Input details received
INFO:werkzeug: * Detected change in 'c:\\Users\\VenkataVivekGoli\\Desktop\\ssis_to_fabric\\modules\\app.py', reloading
INFO:werkzeug: * Restarting with stat
WARNING:werkzeug: * Debugger is active!
INFO:werkzeug: * Debugger PIN: 380-840-231
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5014
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug: * Restarting with stat
WARNING:werkzeug: * Debugger is active!
INFO:werkzeug: * Debugger PIN: 380-840-231
2024-10-08 16:17:48,414 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5014
2024-10-08 16:17:48,414 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2024-10-08 16:17:48,421 - werkzeug - INFO -  * Restarting with stat
2024-10-08 16:17:48,902 - werkzeug - WARNING -  * Debugger is active!
2024-10-08 16:17:48,919 - werkzeug - INFO -  * Debugger PIN: 380-840-231
2024-10-08 16:18:59,815 - root - INFO - File received is Multiple-Dataflows.dtsx
2024-10-08 16:18:59,815 - root - INFO - File saved in temp library
2024-10-08 16:18:59,815 - root - INFO - Input details received
2024-10-08 16:19:01,455 - root - INFO - Access token acquired
2024-10-08 16:19:04,562 - root - INFO - Received the lakehouse id 0717e896-3f43-4721-af39-5c756634a689
2024-10-08 16:19:06,372 - root - INFO - Received the warehouse id 84821c70-f689-4f53-91b8-2b5ad07ea1cd
2024-10-08 16:19:18,793 - werkzeug - INFO - 127.0.0.1 - - [08/Oct/2024 16:19:18] "POST /migrate HTTP/1.1" 200 -
2024-10-08 16:21:36,465 - werkzeug - INFO -  * Detected change in 'c:\\Users\\VenkataVivekGoli\\Desktop\\ssis_to_fabric\\modules\\ssis_fabric.py', reloading
2024-10-08 16:21:36,576 - werkzeug - INFO -  * Restarting with stat
2024-10-08 16:21:37,389 - werkzeug - WARNING -  * Debugger is active!
2024-10-08 16:21:37,407 - werkzeug - INFO -  * Debugger PIN: 380-840-231
2024-10-08 16:22:25,770 - werkzeug - INFO -  * Detected change in 'c:\\Users\\VenkataVivekGoli\\Desktop\\ssis_to_fabric\\modules\\ssis_fabric.py', reloading
2024-10-08 16:22:25,852 - werkzeug - INFO -  * Restarting with stat
2024-10-08 16:22:26,472 - werkzeug - WARNING -  * Debugger is active!
2024-10-08 16:22:26,488 - werkzeug - INFO -  * Debugger PIN: 380-840-231
2024-10-08 16:36:15,714 - werkzeug - INFO -  * Detected change in 'c:\\Users\\VenkataVivekGoli\\Desktop\\ssis_to_fabric\\modules\\ssis_fabric.py', reloading
2024-10-08 16:36:15,804 - werkzeug - INFO -  * Restarting with stat
2024-10-08 16:36:16,436 - werkzeug - WARNING -  * Debugger is active!
2024-10-08 16:36:16,444 - werkzeug - INFO -  * Debugger PIN: 380-840-231
2024-10-08 16:54:05,158 - werkzeug - INFO -  * Detected change in 'c:\\Users\\VenkataVivekGoli\\Desktop\\ssis_to_fabric\\modules\\ssis_fabric.py', reloading
2024-10-08 16:54:05,240 - werkzeug - INFO -  * Restarting with stat
2024-10-08 16:54:05,896 - werkzeug - WARNING -  * Debugger is active!
2024-10-08 16:54:05,904 - werkzeug - INFO -  * Debugger PIN: 380-840-231
2024-10-08 16:55:13,336 - werkzeug - INFO -  * Detected change in 'c:\\Users\\VenkataVivekGoli\\Desktop\\ssis_to_fabric\\modules\\ssis_fabric.py', reloading
2024-10-08 16:55:13,434 - werkzeug - INFO -  * Restarting with stat
2024-10-08 16:55:14,048 - werkzeug - WARNING -  * Debugger is active!
2024-10-08 16:55:14,057 - werkzeug - INFO -  * Debugger PIN: 380-840-231
2024-10-08 17:09:29,032 - werkzeug - INFO -  * Detected change in 'c:\\Users\\VenkataVivekGoli\\Desktop\\ssis_to_fabric\\modules\\ssis_fabric.py', reloading
2024-10-08 17:09:29,117 - werkzeug - INFO -  * Restarting with stat
2024-10-08 17:09:29,995 - werkzeug - WARNING -  * Debugger is active!
2024-10-08 17:09:30,003 - werkzeug - INFO -  * Debugger PIN: 380-840-231
2024-10-08 17:10:08,257 - werkzeug - INFO -  * Detected change in 'c:\\Users\\VenkataVivekGoli\\Desktop\\ssis_to_fabric\\modules\\ssis_fabric.py', reloading
2024-10-08 17:10:08,345 - werkzeug - INFO -  * Restarting with stat
2024-10-08 17:10:09,114 - werkzeug - WARNING -  * Debugger is active!
2024-10-08 17:10:09,123 - werkzeug - INFO -  * Debugger PIN: 380-840-231
2024-10-10 11:45:45,439 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5014
2024-10-10 11:45:45,439 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2024-10-10 11:45:45,457 - werkzeug - INFO -  * Restarting with stat
2024-10-10 11:45:46,049 - werkzeug - WARNING -  * Debugger is active!
2024-10-10 11:45:46,049 - werkzeug - INFO -  * Debugger PIN: 380-840-231
2024-10-10 11:46:12,521 - root - INFO - File received is Multiple-Dataflows.dtsx
2024-10-10 11:46:12,529 - root - INFO - File saved in temp library
2024-10-10 11:46:12,529 - root - INFO - Input details received
2024-10-10 11:46:15,023 - root - ERROR - Function create_token(), Failed to acquire token.
2024-10-10 11:46:15,023 - root - ERROR - Failed to migrate: 'access_token'
2024-10-10 11:46:17,408 - root - ERROR - Function: drop_warehouse_items_fabric(), Error dropping tables/procedures.
2024-10-10 11:46:17,443 - werkzeug - INFO - 127.0.0.1 - - [10/Oct/2024 11:46:17] "[35m[1mPOST /migrate HTTP/1.1[0m" 500 -
2024-10-10 11:52:17,945 - werkzeug - INFO -  * Detected change in 'c:\\Users\\VenkataVivekGoli\\Desktop\\ssis_to_fabric\\modules\\config.py', reloading
2024-10-10 11:52:18,057 - werkzeug - INFO -  * Restarting with stat
2024-10-10 11:52:18,946 - werkzeug - WARNING -  * Debugger is active!
2024-10-10 11:52:18,965 - werkzeug - INFO -  * Debugger PIN: 380-840-231
2024-10-10 11:52:27,775 - root - INFO - File received is Multiple-Dataflows.dtsx
2024-10-10 11:52:27,790 - root - INFO - File saved in temp library
2024-10-10 11:52:27,790 - root - INFO - Input details received
2024-10-10 11:52:29,879 - root - INFO - Access token acquired
2024-10-10 11:52:31,752 - root - INFO - Received the workspace id 87a9f325-0a3f-40e3-954d-bdc5e25bd8b9
2024-10-10 11:52:33,470 - root - INFO - Received the lakehouse id '0717e896-3f43-4721-af39-5c756634a689'
2024-10-10 11:52:35,401 - root - INFO - Received the warehouse id 84821c70-f689-4f53-91b8-2b5ad07ea1cd
2024-10-10 11:52:35,436 - root - INFO - Executables: ['Data Flow Task1', 'Data Flow Task2']
2024-10-10 11:52:35,438 - root - INFO - Executable Data Flow Task1 is a Microsoft.Pipeline
2024-10-10 11:52:35,438 - root - INFO - Parsing the executable Data Flow Task1
2024-10-10 11:52:35,438 - root - INFO - Source_EmployeeContact columns : ['EmployeeID', 'PhoneNumber', 'Email'] dataypes: ['i4', 'wstr', 'wstr']
2024-10-10 11:52:35,438 - root - INFO - Component map : {'Lookup': ['Microsoft.Lookup', False], 'OLE DB Destination': ['Microsoft.OLEDBDestination', False], 'OLE DB Source': ['Microsoft.OLEDBSource', False, 'Source_EmployeeContact']}
2024-10-10 11:52:35,441 - root - INFO - Execution Flow Map: {'Lookup': [['OLE DB Destination', 'Microsoft.OLEDBDestination']], 'OLE DB Destination': [], 'OLE DB Source': [['Lookup', 'Microsoft.Lookup']]}
2024-10-10 11:52:35,441 - root - INFO - Dependency map: {'Lookup': ['OLE DB Source'], 'OLE DB Destination': ['Lookup'], 'OLE DB Source': []}
2024-10-10 11:52:35,447 - root - INFO - Source_EmployeeContact columns : ['EmployeeID', 'PhoneNumber', 'Email'] dataypes: ['i4', 'wstr', 'wstr']
2024-10-10 11:52:35,447 - root - ERROR - Function: design_create_table(), Error making the create table statement for Source_EmployeeContact.
2024-10-10 11:52:35,450 - root - ERROR - Function: parse_dtsx_pipeline(), Error parsing the .dtsx file.
2024-10-10 11:52:35,452 - root - ERROR - Failed to migrate: 'module' object is not callable
2024-10-10 11:52:38,987 - root - INFO - Table 'Source_EmployeeContact' dropped successfully.
2024-10-10 11:52:39,094 - werkzeug - INFO - 127.0.0.1 - - [10/Oct/2024 11:52:39] "[35m[1mPOST /migrate HTTP/1.1[0m" 500 -
2024-10-10 11:55:33,239 - werkzeug - INFO -  * Detected change in 'c:\\Users\\VenkataVivekGoli\\Desktop\\ssis_to_fabric\\modules\\ssis_fabric.py', reloading
2024-10-10 11:55:33,330 - werkzeug - INFO -  * Restarting with stat
2024-10-10 11:55:33,873 - werkzeug - WARNING -  * Debugger is active!
2024-10-10 11:55:33,890 - werkzeug - INFO -  * Debugger PIN: 380-840-231
2024-10-10 11:58:17,087 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5014
2024-10-10 11:58:17,087 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2024-10-10 11:58:17,101 - werkzeug - INFO -  * Restarting with stat
2024-10-10 11:58:17,628 - werkzeug - WARNING -  * Debugger is active!
2024-10-10 11:58:17,645 - werkzeug - INFO -  * Debugger PIN: 380-840-231
2024-10-10 11:58:33,865 - root - INFO - File received is Multiple-Dataflows.dtsx
2024-10-10 11:58:33,868 - root - INFO - File saved in temp library
2024-10-10 11:58:33,868 - root - INFO - Input details received
2024-10-10 11:58:35,663 - root - INFO - Access token acquired
2024-10-10 11:58:38,019 - root - INFO - Received the workspace id 87a9f325-0a3f-40e3-954d-bdc5e25bd8b9
2024-10-10 11:58:39,549 - root - INFO - Received the lakehouse id '0717e896-3f43-4721-af39-5c756634a689'
2024-10-10 11:58:41,388 - root - INFO - Received the warehouse id 84821c70-f689-4f53-91b8-2b5ad07ea1cd
2024-10-10 11:58:41,398 - root - INFO - Executables: ['Data Flow Task1', 'Data Flow Task2']
2024-10-10 11:58:41,398 - root - INFO - Executable Data Flow Task1 is a Microsoft.Pipeline
2024-10-10 11:58:41,398 - root - INFO - Parsing the executable Data Flow Task1
2024-10-10 11:58:41,405 - root - INFO - Source_EmployeeContact columns : ['EmployeeID', 'PhoneNumber', 'Email'] dataypes: ['i4', 'wstr', 'wstr']
2024-10-10 11:58:41,405 - root - INFO - Component map : {'Lookup': ['Microsoft.Lookup', False], 'OLE DB Destination': ['Microsoft.OLEDBDestination', False], 'OLE DB Source': ['Microsoft.OLEDBSource', False, 'Source_EmployeeContact']}
2024-10-10 11:58:41,405 - root - INFO - Execution Flow Map: {'Lookup': [['OLE DB Destination', 'Microsoft.OLEDBDestination']], 'OLE DB Destination': [], 'OLE DB Source': [['Lookup', 'Microsoft.Lookup']]}
2024-10-10 11:58:41,405 - root - INFO - Dependency map: {'Lookup': ['OLE DB Source'], 'OLE DB Destination': ['Lookup'], 'OLE DB Source': []}
2024-10-10 11:58:41,405 - root - INFO - Source_EmployeeContact columns : ['EmployeeID', 'PhoneNumber', 'Email'] dataypes: ['i4', 'wstr', 'wstr']
2024-10-10 11:58:41,405 - root - INFO - create table statement designed for table name Source_EmployeeContact
CREATE TABLE Source_EmployeeContact (EmployeeID INT, PhoneNumber VARCHAR(100), Email VARCHAR(100));
2024-10-10 11:58:45,043 - root - INFO - Table/Procedure created successfully.
2024-10-10 11:58:45,086 - root - INFO - JSON for CopyActivity1 created and added to pipeline.json
2024-10-10 11:58:45,087 - root - INFO - Input columns for Lookup are ['EmployeeID', 'PhoneNumber', 'Email']
2024-10-10 11:58:45,087 - root - INFO - Referred columns in Lookup are ['FirstName', 'LastName', 'Department']
2024-10-10 11:58:45,091 - root - INFO - create table statement designed for table name Source_EmployeeInfo
CREATE TABLE Source_EmployeeInfo (EmployeeID INT, FirstName VARCHAR(100), LastName VARCHAR(100), Department VARCHAR(100));
2024-10-10 11:58:45,148 - root - ERROR - Function: create_warehouse_item_fabric(), Error creating table/procedure in Fabric warehouse.
2024-10-10 11:58:45,148 - root - ERROR - Function: parse_components(), Error in parsing the components.
2024-10-10 11:58:45,148 - root - ERROR - Function: parse_dtsx_pipeline(), Error parsing the .dtsx file.
2024-10-10 11:58:45,157 - root - ERROR - Failed to migrate: ('42S01', "[42S01] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]There is already an object named 'Source_EmployeeInfo' in the database. (2714) (SQLExecDirectW); [42S01] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement ID: {C13EDE0A-6ABE-4347-9937-F64262D10A22} (24528)")
2024-10-10 11:58:46,245 - root - INFO - Table 'Source_EmployeeContact' dropped successfully.
2024-10-10 11:58:46,392 - root - INFO - Table 'Source_EmployeeInfo' dropped successfully.
2024-10-10 11:58:46,469 - root - INFO - pipeline.json cleaned up
2024-10-10 11:58:46,469 - root - INFO - payload.json cleaned up
2024-10-10 11:58:46,481 - werkzeug - INFO - 127.0.0.1 - - [10/Oct/2024 11:58:46] "[35m[1mPOST /migrate HTTP/1.1[0m" 500 -
2024-10-10 12:04:47,821 - root - INFO - File received is Multiple-Dataflows.dtsx
2024-10-10 12:04:47,821 - root - INFO - File saved in temp library
2024-10-10 12:04:47,821 - root - INFO - Input details received
2024-10-10 12:04:51,571 - root - INFO - Access token acquired
2024-10-10 12:04:54,390 - root - INFO - Received the workspace id 87a9f325-0a3f-40e3-954d-bdc5e25bd8b9
2024-10-10 12:04:56,598 - root - INFO - Received the lakehouse id '0717e896-3f43-4721-af39-5c756634a689'
2024-10-10 12:04:58,429 - root - INFO - Received the warehouse id 84821c70-f689-4f53-91b8-2b5ad07ea1cd
2024-10-10 12:04:58,466 - root - INFO - Executables: ['Data Flow Task1', 'Data Flow Task2']
2024-10-10 12:04:58,466 - root - INFO - Executable Data Flow Task1 is a Microsoft.Pipeline
2024-10-10 12:04:58,466 - root - INFO - Parsing the executable Data Flow Task1
2024-10-10 12:04:58,469 - root - INFO - Source_EmployeeContact columns : ['EmployeeID', 'PhoneNumber', 'Email'] dataypes: ['i4', 'wstr', 'wstr']
2024-10-10 12:04:58,469 - root - INFO - Component map : {'Lookup': ['Microsoft.Lookup', False], 'OLE DB Destination': ['Microsoft.OLEDBDestination', False], 'OLE DB Source': ['Microsoft.OLEDBSource', False, 'Source_EmployeeContact']}
2024-10-10 12:04:58,469 - root - INFO - Execution Flow Map: {'Lookup': [['OLE DB Destination', 'Microsoft.OLEDBDestination']], 'OLE DB Destination': [], 'OLE DB Source': [['Lookup', 'Microsoft.Lookup']]}
2024-10-10 12:04:58,474 - root - INFO - Dependency map: {'Lookup': ['OLE DB Source'], 'OLE DB Destination': ['Lookup'], 'OLE DB Source': []}
2024-10-10 12:04:58,475 - root - INFO - Source_EmployeeContact columns : ['EmployeeID', 'PhoneNumber', 'Email'] dataypes: ['i4', 'wstr', 'wstr']
2024-10-10 12:04:58,476 - root - INFO - create table statement designed for table name Source_EmployeeContact
CREATE TABLE Source_EmployeeContact (EmployeeID INT, PhoneNumber VARCHAR(100), Email VARCHAR(100));
2024-10-10 12:05:01,286 - root - INFO - Table/Procedure created successfully.
2024-10-10 12:05:01,337 - root - INFO - JSON for CopyActivity1 created and added to pipeline.json
2024-10-10 12:05:01,337 - root - INFO - Input columns for Lookup are ['EmployeeID', 'PhoneNumber', 'Email']
2024-10-10 12:05:01,337 - root - INFO - Referred columns in Lookup are ['FirstName', 'LastName', 'Department']
2024-10-10 12:05:01,337 - root - INFO - create table statement designed for table name Source_EmployeeInfo
CREATE TABLE Source_EmployeeInfo (EmployeeID INT, FirstName VARCHAR(100), LastName VARCHAR(100), Department VARCHAR(100));
2024-10-10 12:05:03,814 - root - INFO - Table/Procedure created successfully.
2024-10-10 12:05:03,870 - root - INFO - JSON for CopyActivity2 created and added to pipeline.json
2024-10-10 12:05:04,001 - root - INFO - Table/Procedure created successfully.
2024-10-10 12:05:04,148 - root - INFO - JSON for StoredProcedure1 created successfully.
2024-10-10 12:05:04,148 - root - INFO - Component OLE DB Source is parsed
2024-10-10 12:05:04,151 - root - INFO - Component Lookup is parsed
2024-10-10 12:05:04,152 - root - INFO - Component OLE DB Destination is parsed
2024-10-10 12:05:04,152 - root - INFO - Component OLE DB Source is parsed
2024-10-10 12:05:04,152 - root - INFO - Resultant component map {'Lookup': ['Microsoft.Lookup', True, 'StoredProcedure1'], 'OLE DB Destination': ['Microsoft.OLEDBDestination', True], 'OLE DB Source': ['Microsoft.OLEDBSource', True, 'Source_EmployeeContact', 'CopyActivity1']}
2024-10-10 12:05:04,152 - root - INFO - Executables last activitites map: {'Data Flow Task1': ['StoredProcedure1']}
2024-10-10 12:05:04,152 - root - INFO - Executable Data Flow Task2 is a Microsoft.Pipeline
2024-10-10 12:05:04,159 - root - INFO - Parsing the executable Data Flow Task2
2024-10-10 12:05:04,160 - root - INFO - AProduct columns : ['Product_ID', 'Product_Name', 'Category'] dataypes: ['i4', 'str', 'str']
2024-10-10 12:05:04,161 - root - INFO - APurchases columns : ['Purchase_ID', 'Product_ID', 'Quantity_Sold', 'Amount'] dataypes: ['i4', 'i4', 'i4', 'numeric']
2024-10-10 12:05:04,163 - root - INFO - Component map : {'Merge Join': ['Microsoft.MergeJoin', False], 'OLE DB Destination': ['Microsoft.OLEDBDestination', False], 'Products': ['Microsoft.OLEDBSource', False, 'AProduct'], 'Purchases': ['Microsoft.OLEDBSource', False, 'APurchases'], 'Sort': ['Microsoft.Sort', False], 'Sort 1': ['Microsoft.Sort', False]}
2024-10-10 12:05:04,164 - root - INFO - Execution Flow Map: {'Merge Join': [['OLE DB Destination', 'Microsoft.OLEDBDestination']], 'OLE DB Destination': [], 'Products': [['Sort 1', 'Microsoft.Sort']], 'Purchases': [['Sort', 'Microsoft.Sort']], 'Sort': [['Merge Join', 'Microsoft.MergeJoin']], 'Sort 1': [['Merge Join', 'Microsoft.MergeJoin']]}
2024-10-10 12:05:04,164 - root - INFO - Dependency map: {'Merge Join': ['Sort', 'Sort 1'], 'OLE DB Destination': ['Merge Join'], 'Products': [], 'Purchases': [], 'Sort': ['Purchases'], 'Sort 1': ['Products']}
2024-10-10 12:05:04,164 - root - INFO - AProduct columns : ['Product_ID', 'Product_Name', 'Category'] dataypes: ['i4', 'str', 'str']
2024-10-10 12:05:04,170 - root - INFO - create table statement designed for table name AProduct
CREATE TABLE AProduct (Product_ID INT, Product_Name VARCHAR(100), Category VARCHAR(100));
2024-10-10 12:05:04,432 - root - INFO - Table/Procedure created successfully.
2024-10-10 12:05:04,479 - root - INFO - JSON for CopyActivity3 created and added to pipeline.json
2024-10-10 12:05:04,479 - root - INFO - APurchases columns : ['Purchase_ID', 'Product_ID', 'Quantity_Sold', 'Amount'] dataypes: ['i4', 'i4', 'i4', 'numeric']
2024-10-10 12:05:04,486 - root - INFO - create table statement designed for table name APurchases
CREATE TABLE APurchases (Purchase_ID INT, Product_ID INT, Quantity_Sold INT, Amount DECIMAL(38,2));
2024-10-10 12:05:04,846 - root - INFO - Table/Procedure created successfully.
2024-10-10 12:05:04,892 - root - INFO - JSON for CopyActivity4 created and added to pipeline.json
2024-10-10 12:05:04,892 - root - INFO - Left Input columns for Merge Join are ['Product_ID', 'Purchase_ID', 'Quantity_Sold', 'Amount'] sorted as {1: 'Product_ID'}
2024-10-10 12:05:04,892 - root - INFO - Right Input columns for Merge Join are ['Product_ID', 'Product_Name', 'Category'] sorted as {1: 'Product_ID'}
2024-10-10 12:05:04,892 - root - INFO - Output columns from Merge Join are ['Purchase_ID', 'Product_ID', 'Product_Name', 'Category', 'Quantity_Sold', 'Amount']
2024-10-10 12:05:05,041 - root - INFO - Table/Procedure created successfully.
2024-10-10 12:05:05,083 - root - INFO - JSON for StoredProcedure2 created successfully.
2024-10-10 12:05:05,083 - root - INFO - Component Products is parsed
2024-10-10 12:05:05,083 - root - INFO - Component Purchases is parsed
2024-10-10 12:05:05,083 - root - INFO - Component Sort is parsed
2024-10-10 12:05:05,083 - root - INFO - Component Sort 1 is parsed
2024-10-10 12:05:05,083 - root - INFO - Component Merge Join is parsed
2024-10-10 12:05:05,083 - root - INFO - Component OLE DB Destination is parsed
2024-10-10 12:05:05,089 - root - INFO - Component Products is parsed
2024-10-10 12:05:05,089 - root - INFO - Component Purchases is parsed
2024-10-10 12:05:05,091 - root - INFO - Component Sort is parsed
2024-10-10 12:05:05,093 - root - INFO - Component Sort 1 is parsed
2024-10-10 12:05:05,093 - root - INFO - Resultant component map {'Merge Join': ['Microsoft.MergeJoin', True, 'StoredProcedure2'], 'OLE DB Destination': ['Microsoft.OLEDBDestination', True], 'Products': ['Microsoft.OLEDBSource', True, 'AProduct', 'CopyActivity3'], 'Purchases': ['Microsoft.OLEDBSource', True, 'APurchases', 'CopyActivity4'], 'Sort': ['Microsoft.Sort', True, 'APurchases', 'CopyActivity4'], 'Sort 1': ['Microsoft.Sort', True, 'AProduct', 'CopyActivity3']}
2024-10-10 12:05:05,093 - root - INFO - Executables last activitites map: {'Data Flow Task1': ['StoredProcedure1'], 'Data Flow Task2': ['StoredProcedure2']}
2024-10-10 12:05:05,098 - root - INFO - Added pipeline name to pipeline.json
2024-10-10 12:05:05,106 - root - INFO - Encoded pipeline.json into base64 format
2024-10-10 12:05:05,110 - root - INFO - pipeline.json cleaned up
2024-10-10 12:05:05,112 - root - INFO - payload created for API request
2024-10-10 12:05:06,097 - root - INFO - payload.json cleaned up
2024-10-10 12:05:06,097 - root - INFO - Failed to create pipeline
{'requestId': 'e65400ce-f301-491c-b9ad-ea9d95225806', 'errorCode': 'ItemDisplayNameAlreadyInUse', 'message': "Requested '2-dataflows' is already in use"}
2024-10-10 12:05:06,097 - root - ERROR - Function create_pipeline(), Error creating the pipeline
2024-10-10 12:05:06,097 - root - ERROR - Failed to migrate: Failed to create pipeline. Status code: 400, Response: {'requestId': 'e65400ce-f301-491c-b9ad-ea9d95225806', 'errorCode': 'ItemDisplayNameAlreadyInUse', 'message': "Requested '2-dataflows' is already in use"}
2024-10-10 12:05:06,241 - root - INFO - Table 'Source_EmployeeContact' dropped successfully.
2024-10-10 12:05:06,305 - root - INFO - Table 'Source_EmployeeInfo' dropped successfully.
2024-10-10 12:05:06,408 - root - INFO - Table 'AProduct' dropped successfully.
2024-10-10 12:05:06,549 - root - INFO - Table 'APurchases' dropped successfully.
2024-10-10 12:05:06,590 - root - INFO - Procedure 'Lookup_Source_Employee' dropped successfully.
2024-10-10 12:05:06,635 - root - INFO - Procedure 'Merge_APurchasesFlow2' dropped successfully.
2024-10-10 12:05:06,706 - root - INFO - pipeline.json cleaned up
2024-10-10 12:05:06,706 - root - INFO - payload.json cleaned up
2024-10-10 12:05:06,718 - werkzeug - INFO - 127.0.0.1 - - [10/Oct/2024 12:05:06] "[35m[1mPOST /migrate HTTP/1.1[0m" 500 -
2024-10-10 12:09:19,459 - werkzeug - INFO -  * Detected change in 'c:\\Users\\VenkataVivekGoli\\Desktop\\ssis_to_fabric\\modules\\ssis_fabric.py', reloading
2024-10-10 12:09:19,571 - werkzeug - INFO -  * Restarting with stat
2024-10-10 12:09:20,488 - werkzeug - WARNING -  * Debugger is active!
2024-10-10 12:09:20,495 - werkzeug - INFO -  * Debugger PIN: 380-840-231
2024-10-10 12:14:04,883 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5014
2024-10-10 12:14:04,883 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2024-10-10 12:14:04,890 - werkzeug - INFO -  * Restarting with stat
2024-10-10 12:14:05,231 - werkzeug - WARNING -  * Debugger is active!
2024-10-10 12:14:05,247 - werkzeug - INFO -  * Debugger PIN: 380-840-231
2024-10-10 12:14:16,424 - root - INFO - File received is Multiple-Dataflows.dtsx
2024-10-10 12:14:16,438 - root - INFO - File saved in temp library
2024-10-10 12:14:16,438 - root - INFO - Input details received
2024-10-10 12:14:17,837 - root - INFO - Access token acquired
2024-10-10 12:14:18,755 - root - INFO - Received the workspace id 87a9f325-0a3f-40e3-954d-bdc5e25bd8b9
2024-10-10 12:14:20,250 - root - INFO - Received the lakehouse id '0717e896-3f43-4721-af39-5c756634a689'
2024-10-10 12:14:21,571 - root - INFO - Received the warehouse id 84821c70-f689-4f53-91b8-2b5ad07ea1cd
2024-10-10 12:14:21,580 - root - INFO - Executables: ['Data Flow Task1', 'Data Flow Task2']
2024-10-10 12:14:21,581 - root - INFO - Executable Data Flow Task1 is a Microsoft.Pipeline
2024-10-10 12:14:21,582 - root - INFO - Parsing the executable Data Flow Task1
2024-10-10 12:14:21,584 - root - INFO - Source_EmployeeContact columns : ['EmployeeID', 'PhoneNumber', 'Email'] dataypes: ['i4', 'wstr', 'wstr']
2024-10-10 12:14:21,585 - root - INFO - Component map : {'Lookup': ['Microsoft.Lookup', False], 'OLE DB Destination': ['Microsoft.OLEDBDestination', False], 'OLE DB Source': ['Microsoft.OLEDBSource', False, 'Source_EmployeeContact']}
2024-10-10 12:14:21,587 - root - INFO - Execution Flow Map: {'Lookup': [['OLE DB Destination', 'Microsoft.OLEDBDestination']], 'OLE DB Destination': [], 'OLE DB Source': [['Lookup', 'Microsoft.Lookup']]}
2024-10-10 12:14:21,588 - root - INFO - Dependency map: {'Lookup': ['OLE DB Source'], 'OLE DB Destination': ['Lookup'], 'OLE DB Source': []}
2024-10-10 12:14:21,590 - root - INFO - Source_EmployeeContact columns : ['EmployeeID', 'PhoneNumber', 'Email'] dataypes: ['i4', 'wstr', 'wstr']
2024-10-10 12:14:21,592 - root - INFO - create table statement designed for table name Source_EmployeeContact
CREATE TABLE Source_EmployeeContact (EmployeeID INT, PhoneNumber VARCHAR(100), Email VARCHAR(100));
2024-10-10 12:14:26,147 - root - INFO - Table/Procedure created successfully.
2024-10-10 12:14:26,207 - root - INFO - JSON for CopyActivity1 created and added to pipeline.json
2024-10-10 12:14:26,211 - root - INFO - Input columns for Lookup are ['EmployeeID', 'PhoneNumber', 'Email']
2024-10-10 12:14:26,212 - root - INFO - Referred columns in Lookup are ['FirstName', 'LastName', 'Department']
2024-10-10 12:14:26,214 - root - INFO - create table statement designed for table name Source_EmployeeInfo
CREATE TABLE Source_EmployeeInfo (EmployeeID INT, FirstName VARCHAR(100), LastName VARCHAR(100), Department VARCHAR(100));
2024-10-10 12:14:26,594 - root - INFO - Table/Procedure created successfully.
2024-10-10 12:14:26,652 - root - INFO - JSON for CopyActivity2 created and added to pipeline.json
2024-10-10 12:14:26,808 - root - INFO - Table/Procedure created successfully.
2024-10-10 12:14:26,842 - root - INFO - Procedure: 
                        CREATE PROCEDURE Lookup_Source_Employee AS
                        BEGIN
                            IF OBJECT_ID('Source_Employee', 'U') IS NOT NULL
                            BEGIN
                                DROP TABLE Source_Employee;
                            END
                            CREATE TABLE Source_Employee AS
                            SELECT t1.EmployeeID, t1.PhoneNumber, t1.Email, t2.FirstName AS FirstName, t2.LastName AS LastName, t2.Department AS Department FROM dbo.Source_EmployeeContact AS t1 JOIN dbo.Source_EmployeeInfo AS t2 ON t1.EmployeeID = t2.EmployeeID
                        END;
                    
2024-10-10 12:14:26,854 - root - INFO - JSON for StoredProcedure1 created successfully.
2024-10-10 12:14:26,855 - root - INFO - Component OLE DB Source is parsed
2024-10-10 12:14:26,856 - root - INFO - Component Lookup is parsed
2024-10-10 12:14:26,858 - root - INFO - Component OLE DB Destination is parsed
2024-10-10 12:14:26,859 - root - INFO - Component OLE DB Source is parsed
2024-10-10 12:14:26,860 - root - INFO - Resultant component map {'Lookup': ['Microsoft.Lookup', True, 'StoredProcedure1'], 'OLE DB Destination': ['Microsoft.OLEDBDestination', True], 'OLE DB Source': ['Microsoft.OLEDBSource', True, 'Source_EmployeeContact', 'CopyActivity1']}
2024-10-10 12:14:26,861 - root - INFO - Executables last activitites map: {'Data Flow Task1': ['StoredProcedure1']}
2024-10-10 12:14:26,863 - root - INFO - Executable Data Flow Task2 is a Microsoft.Pipeline
2024-10-10 12:14:26,864 - root - INFO - Parsing the executable Data Flow Task2
2024-10-10 12:14:26,866 - root - INFO - AProduct columns : ['Product_ID', 'Product_Name', 'Category'] dataypes: ['i4', 'str', 'str']
2024-10-10 12:14:26,868 - root - INFO - APurchases columns : ['Purchase_ID', 'Product_ID', 'Quantity_Sold', 'Amount'] dataypes: ['i4', 'i4', 'i4', 'numeric']
2024-10-10 12:14:26,869 - root - INFO - Component map : {'Merge Join': ['Microsoft.MergeJoin', False], 'OLE DB Destination': ['Microsoft.OLEDBDestination', False], 'Products': ['Microsoft.OLEDBSource', False, 'AProduct'], 'Purchases': ['Microsoft.OLEDBSource', False, 'APurchases'], 'Sort': ['Microsoft.Sort', False], 'Sort 1': ['Microsoft.Sort', False]}
2024-10-10 12:14:26,872 - root - INFO - Execution Flow Map: {'Merge Join': [['OLE DB Destination', 'Microsoft.OLEDBDestination']], 'OLE DB Destination': [], 'Products': [['Sort 1', 'Microsoft.Sort']], 'Purchases': [['Sort', 'Microsoft.Sort']], 'Sort': [['Merge Join', 'Microsoft.MergeJoin']], 'Sort 1': [['Merge Join', 'Microsoft.MergeJoin']]}
2024-10-10 12:14:26,874 - root - INFO - Dependency map: {'Merge Join': ['Sort', 'Sort 1'], 'OLE DB Destination': ['Merge Join'], 'Products': [], 'Purchases': [], 'Sort': ['Purchases'], 'Sort 1': ['Products']}
2024-10-10 12:14:26,876 - root - INFO - AProduct columns : ['Product_ID', 'Product_Name', 'Category'] dataypes: ['i4', 'str', 'str']
2024-10-10 12:14:26,879 - root - INFO - create table statement designed for table name AProduct
CREATE TABLE AProduct (Product_ID INT, Product_Name VARCHAR(100), Category VARCHAR(100));
2024-10-10 12:14:27,273 - root - INFO - Table/Procedure created successfully.
2024-10-10 12:14:27,430 - root - INFO - JSON for CopyActivity3 created and added to pipeline.json
2024-10-10 12:14:27,432 - root - INFO - APurchases columns : ['Purchase_ID', 'Product_ID', 'Quantity_Sold', 'Amount'] dataypes: ['i4', 'i4', 'i4', 'numeric']
2024-10-10 12:14:27,434 - root - INFO - create table statement designed for table name APurchases
CREATE TABLE APurchases (Purchase_ID INT, Product_ID INT, Quantity_Sold INT, Amount DECIMAL(38,2));
2024-10-10 12:14:28,295 - root - INFO - Table/Procedure created successfully.
2024-10-10 12:14:28,354 - root - INFO - JSON for CopyActivity4 created and added to pipeline.json
2024-10-10 12:14:28,357 - root - INFO - Left Input columns for Merge Join are ['Product_ID', 'Purchase_ID', 'Quantity_Sold', 'Amount'] sorted as {1: 'Product_ID'}
2024-10-10 12:14:28,359 - root - INFO - Right Input columns for Merge Join are ['Product_ID', 'Product_Name', 'Category'] sorted as {1: 'Product_ID'}
2024-10-10 12:14:28,360 - root - INFO - Output columns from Merge Join are ['Purchase_ID', 'Product_ID', 'Product_Name', 'Category', 'Quantity_Sold', 'Amount']
2024-10-10 12:14:28,363 - root - INFO - Procedure: 
                        CREATE PROCEDURE Merge_APurchasesFlow2 AS
                        BEGIN
                            IF OBJECT_ID('APurchasesFlow2', 'U') IS NOT NULL
                            BEGIN
                                DROP TABLE APurchasesFlow2;
                            END
                            CREATE TABLE APurchasesFlow2 AS
                            SELECT t1.Purchase_ID AS Purchase_ID, t1.Product_ID AS Product_ID, t2.Product_Name AS Product_Name, t2.Category AS Category, t1.Quantity_Sold AS Quantity_Sold, t1.Amount AS Amount FROM dbo.APurchases AS t1 INNER JOIN dbo.AProduct AS t2 ON t1.Product_ID = t2.Product_ID;
                        END;
                    
2024-10-10 12:14:28,665 - root - INFO - Table/Procedure created successfully.
2024-10-10 12:14:28,701 - root - INFO - JSON for StoredProcedure2 created successfully.
2024-10-10 12:14:28,702 - root - INFO - Component Products is parsed
2024-10-10 12:14:28,703 - root - INFO - Component Purchases is parsed
2024-10-10 12:14:28,704 - root - INFO - Component Sort is parsed
2024-10-10 12:14:28,705 - root - INFO - Component Sort 1 is parsed
2024-10-10 12:14:28,706 - root - INFO - Component Merge Join is parsed
2024-10-10 12:14:28,707 - root - INFO - Component OLE DB Destination is parsed
2024-10-10 12:14:28,708 - root - INFO - Component Products is parsed
2024-10-10 12:14:28,709 - root - INFO - Component Purchases is parsed
2024-10-10 12:14:28,710 - root - INFO - Component Sort is parsed
2024-10-10 12:14:28,711 - root - INFO - Component Sort 1 is parsed
2024-10-10 12:14:28,712 - root - INFO - Resultant component map {'Merge Join': ['Microsoft.MergeJoin', True, 'StoredProcedure2'], 'OLE DB Destination': ['Microsoft.OLEDBDestination', True], 'Products': ['Microsoft.OLEDBSource', True, 'AProduct', 'CopyActivity3'], 'Purchases': ['Microsoft.OLEDBSource', True, 'APurchases', 'CopyActivity4'], 'Sort': ['Microsoft.Sort', True, 'APurchases', 'CopyActivity4'], 'Sort 1': ['Microsoft.Sort', True, 'AProduct', 'CopyActivity3']}
2024-10-10 12:14:28,715 - root - INFO - Executables last activitites map: {'Data Flow Task1': ['StoredProcedure1'], 'Data Flow Task2': ['StoredProcedure2']}
2024-10-10 12:14:28,719 - root - INFO - Added pipeline name to pipeline.json
2024-10-10 12:14:28,728 - root - INFO - Encoded pipeline.json into base64 format
2024-10-10 12:14:28,735 - root - INFO - pipeline.json cleaned up
2024-10-10 12:14:28,739 - root - INFO - payload created for API request
2024-10-10 12:14:30,274 - root - INFO - payload.json cleaned up
2024-10-10 12:14:30,275 - root - INFO - Failed to create pipeline
{'requestId': 'bc4b9845-d3c4-49ff-9c03-e71771576101', 'errorCode': 'ItemDisplayNameAlreadyInUse', 'message': "Requested '2-dataflows' is already in use"}
2024-10-10 12:14:30,276 - root - ERROR - Function create_pipeline(), Error creating the pipeline
2024-10-10 12:14:30,277 - root - ERROR - Failed to migrate: Failed to create pipeline. Status code: 400, Response: {'requestId': 'bc4b9845-d3c4-49ff-9c03-e71771576101', 'errorCode': 'ItemDisplayNameAlreadyInUse', 'message': "Requested '2-dataflows' is already in use"}
2024-10-10 12:14:30,720 - root - INFO - Table 'Source_EmployeeContact' dropped successfully.
2024-10-10 12:14:30,874 - root - INFO - Table 'Source_EmployeeInfo' dropped successfully.
2024-10-10 12:14:30,964 - root - INFO - Table 'AProduct' dropped successfully.
2024-10-10 12:14:31,104 - root - INFO - Table 'APurchases' dropped successfully.
2024-10-10 12:14:31,185 - root - INFO - Procedure 'Lookup_Source_Employee' dropped successfully.
2024-10-10 12:14:31,252 - root - INFO - Procedure 'Merge_APurchasesFlow2' dropped successfully.
2024-10-10 12:14:31,366 - root - INFO - pipeline.json cleaned up
2024-10-10 12:14:31,369 - root - INFO - payload.json cleaned up
2024-10-10 12:14:31,374 - werkzeug - INFO - 127.0.0.1 - - [10/Oct/2024 12:14:31] "[35m[1mPOST /migrate HTTP/1.1[0m" 500 -
2024-10-14 12:27:43,433 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5014
2024-10-14 12:27:43,433 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2024-10-14 12:27:43,443 - werkzeug - INFO -  * Restarting with stat
2024-10-14 12:27:44,006 - werkzeug - WARNING -  * Debugger is active!
2024-10-14 12:27:44,022 - werkzeug - INFO -  * Debugger PIN: 380-840-231
2024-10-14 12:28:18,862 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5014
2024-10-14 12:28:18,862 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2024-10-14 12:28:18,872 - werkzeug - INFO -  * Restarting with stat
2024-10-14 12:28:19,384 - werkzeug - WARNING -  * Debugger is active!
2024-10-14 12:28:19,402 - werkzeug - INFO -  * Debugger PIN: 380-840-231
2024-10-14 12:28:28,981 - root - INFO - File received is Multiple-Dataflows.dtsx
2024-10-14 12:28:28,997 - root - INFO - File saved in temp library
2024-10-14 12:28:28,997 - root - INFO - Input details received
2024-10-14 12:28:31,052 - root - INFO - Access token acquired
2024-10-14 12:28:33,405 - root - INFO - Received the workspace id 87a9f325-0a3f-40e3-954d-bdc5e25bd8b9
2024-10-14 12:28:35,960 - root - INFO - Received the lakehouse id '0717e896-3f43-4721-af39-5c756634a689'
2024-10-14 12:28:37,596 - root - INFO - Received the warehouse id 84821c70-f689-4f53-91b8-2b5ad07ea1cd
2024-10-14 12:28:37,614 - root - INFO - Executables: ['Data Flow Task1', 'Data Flow Task2']
2024-10-14 12:28:37,614 - root - INFO - Executable Data Flow Task1 is a Microsoft.Pipeline
2024-10-14 12:28:37,620 - root - INFO - Parsing the executable Data Flow Task1
2024-10-14 12:28:37,621 - root - INFO - Source_EmployeeContact columns : ['EmployeeID', 'PhoneNumber', 'Email'] dataypes: ['i4', 'wstr', 'wstr']
2024-10-14 12:28:37,622 - root - INFO - Component map : {'Lookup': ['Microsoft.Lookup', False], 'OLE DB Destination': ['Microsoft.OLEDBDestination', False], 'OLE DB Source': ['Microsoft.OLEDBSource', False, 'Source_EmployeeContact']}
2024-10-14 12:28:37,622 - root - INFO - Execution Flow Map: {'Lookup': [['OLE DB Destination', 'Microsoft.OLEDBDestination']], 'OLE DB Destination': [], 'OLE DB Source': [['Lookup', 'Microsoft.Lookup']]}
2024-10-14 12:28:37,622 - root - INFO - Dependency map: {'Lookup': ['OLE DB Source'], 'OLE DB Destination': ['Lookup'], 'OLE DB Source': []}
2024-10-14 12:28:37,622 - root - INFO - Source_EmployeeContact columns : ['EmployeeID', 'PhoneNumber', 'Email'] dataypes: ['i4', 'wstr', 'wstr']
2024-10-14 12:28:37,626 - root - INFO - create table statement designed for table name Source_EmployeeContact
CREATE TABLE Source_EmployeeContact (EmployeeID INT, PhoneNumber VARCHAR(100), Email VARCHAR(100));
2024-10-14 12:28:43,225 - root - INFO - Table/Procedure created successfully.
2024-10-14 12:28:43,279 - root - INFO - JSON for CopyActivity1 created and added to pipeline.json
2024-10-14 12:28:43,283 - root - INFO - Input columns for Lookup are ['EmployeeID', 'PhoneNumber', 'Email']
2024-10-14 12:28:43,283 - root - INFO - Referred columns in Lookup are ['FirstName', 'LastName', 'Department']
2024-10-14 12:28:43,283 - root - INFO - create table statement designed for table name Source_EmployeeInfo
CREATE TABLE Source_EmployeeInfo (EmployeeID INT, FirstName VARCHAR(100), LastName VARCHAR(100), Department VARCHAR(100));
2024-10-14 12:28:43,688 - root - INFO - Table/Procedure created successfully.
2024-10-14 12:28:43,729 - root - INFO - JSON for CopyActivity2 created and added to pipeline.json
2024-10-14 12:28:43,884 - root - INFO - Table/Procedure created successfully.
2024-10-14 12:28:43,926 - root - INFO - Procedure: 
                        CREATE PROCEDURE Lookup_Source_Employee AS
                        BEGIN
                            IF OBJECT_ID('Source_Employee', 'U') IS NOT NULL
                            BEGIN
                                DROP TABLE Source_Employee;
                            END
                            CREATE TABLE Source_Employee AS
                            SELECT t1.EmployeeID, t1.PhoneNumber, t1.Email, t2.FirstName AS FirstName, t2.LastName AS LastName, t2.Department AS Department FROM dbo.Source_EmployeeContact AS t1 JOIN dbo.Source_EmployeeInfo AS t2 ON t1.EmployeeID = t2.EmployeeID
                        END;
                    
2024-10-14 12:28:43,945 - root - INFO - JSON for StoredProcedure1 created successfully.
2024-10-14 12:28:43,946 - root - INFO - Component OLE DB Source is parsed
2024-10-14 12:28:43,949 - root - INFO - Component Lookup is parsed
2024-10-14 12:28:43,949 - root - INFO - Component OLE DB Destination is parsed
2024-10-14 12:28:43,949 - root - INFO - Component OLE DB Source is parsed
2024-10-14 12:28:43,949 - root - INFO - Resultant component map {'Lookup': ['Microsoft.Lookup', True, 'StoredProcedure1'], 'OLE DB Destination': ['Microsoft.OLEDBDestination', True], 'OLE DB Source': ['Microsoft.OLEDBSource', True, 'Source_EmployeeContact', 'CopyActivity1']}
2024-10-14 12:28:43,949 - root - INFO - Executables last activitites map: {'Data Flow Task1': ['StoredProcedure1']}
2024-10-14 12:28:43,949 - root - INFO - Executable Data Flow Task2 is a Microsoft.Pipeline
2024-10-14 12:28:43,949 - root - INFO - Parsing the executable Data Flow Task2
2024-10-14 12:28:43,957 - root - INFO - AProduct columns : ['Product_ID', 'Product_Name', 'Category'] dataypes: ['i4', 'str', 'str']
2024-10-14 12:28:43,957 - root - INFO - APurchases columns : ['Purchase_ID', 'Product_ID', 'Quantity_Sold', 'Amount'] dataypes: ['i4', 'i4', 'i4', 'numeric']
2024-10-14 12:28:43,961 - root - INFO - Component map : {'Merge Join': ['Microsoft.MergeJoin', False], 'OLE DB Destination': ['Microsoft.OLEDBDestination', False], 'Products': ['Microsoft.OLEDBSource', False, 'AProduct'], 'Purchases': ['Microsoft.OLEDBSource', False, 'APurchases'], 'Sort': ['Microsoft.Sort', False], 'Sort 1': ['Microsoft.Sort', False]}
2024-10-14 12:28:43,965 - root - INFO - Execution Flow Map: {'Merge Join': [['OLE DB Destination', 'Microsoft.OLEDBDestination']], 'OLE DB Destination': [], 'Products': [['Sort 1', 'Microsoft.Sort']], 'Purchases': [['Sort', 'Microsoft.Sort']], 'Sort': [['Merge Join', 'Microsoft.MergeJoin']], 'Sort 1': [['Merge Join', 'Microsoft.MergeJoin']]}
2024-10-14 12:28:43,965 - root - INFO - Dependency map: {'Merge Join': ['Sort', 'Sort 1'], 'OLE DB Destination': ['Merge Join'], 'Products': [], 'Purchases': [], 'Sort': ['Purchases'], 'Sort 1': ['Products']}
2024-10-14 12:28:43,965 - root - INFO - AProduct columns : ['Product_ID', 'Product_Name', 'Category'] dataypes: ['i4', 'str', 'str']
2024-10-14 12:28:43,973 - root - INFO - create table statement designed for table name AProduct
CREATE TABLE AProduct (Product_ID INT, Product_Name VARCHAR(100), Category VARCHAR(100));
2024-10-14 12:28:44,417 - root - INFO - Table/Procedure created successfully.
2024-10-14 12:28:44,470 - root - INFO - JSON for CopyActivity3 created and added to pipeline.json
2024-10-14 12:28:44,470 - root - INFO - APurchases columns : ['Purchase_ID', 'Product_ID', 'Quantity_Sold', 'Amount'] dataypes: ['i4', 'i4', 'i4', 'numeric']
2024-10-14 12:28:44,470 - root - INFO - create table statement designed for table name APurchases
CREATE TABLE APurchases (Purchase_ID INT, Product_ID INT, Quantity_Sold INT, Amount DECIMAL(38,2));
2024-10-14 12:28:44,912 - root - INFO - Table/Procedure created successfully.
2024-10-14 12:28:44,960 - root - INFO - JSON for CopyActivity4 created and added to pipeline.json
2024-10-14 12:28:44,962 - root - INFO - Left Input columns for Merge Join are ['Product_ID', 'Purchase_ID', 'Quantity_Sold', 'Amount'] sorted as {1: 'Product_ID'}
2024-10-14 12:28:44,966 - root - INFO - Right Input columns for Merge Join are ['Product_ID', 'Product_Name', 'Category'] sorted as {1: 'Product_ID'}
2024-10-14 12:28:44,966 - root - INFO - Output columns from Merge Join are ['Purchase_ID', 'Product_ID', 'Product_Name', 'Category', 'Quantity_Sold', 'Amount']
2024-10-14 12:28:44,970 - root - INFO - Procedure: 
                        CREATE PROCEDURE Merge_APurchasesFlow2 AS
                        BEGIN
                            IF OBJECT_ID('APurchasesFlow2', 'U') IS NOT NULL
                            BEGIN
                                DROP TABLE APurchasesFlow2;
                            END
                            CREATE TABLE APurchasesFlow2 AS
                            SELECT t1.Purchase_ID AS Purchase_ID, t1.Product_ID AS Product_ID, t2.Product_Name AS Product_Name, t2.Category AS Category, t1.Quantity_Sold AS Quantity_Sold, t1.Amount AS Amount FROM dbo.APurchases AS t1 INNER JOIN dbo.AProduct AS t2 ON t1.Product_ID = t2.Product_ID;
                        END;
                    
2024-10-14 12:28:45,086 - root - INFO - Table/Procedure created successfully.
2024-10-14 12:28:45,132 - root - INFO - JSON for StoredProcedure2 created successfully.
2024-10-14 12:28:45,132 - root - INFO - Component Products is parsed
2024-10-14 12:28:45,132 - root - INFO - Component Purchases is parsed
2024-10-14 12:28:45,132 - root - INFO - Component Sort is parsed
2024-10-14 12:28:45,132 - root - INFO - Component Sort 1 is parsed
2024-10-14 12:28:45,141 - root - INFO - Component Merge Join is parsed
2024-10-14 12:28:45,141 - root - INFO - Component OLE DB Destination is parsed
2024-10-14 12:28:45,141 - root - INFO - Component Products is parsed
2024-10-14 12:28:45,141 - root - INFO - Component Purchases is parsed
2024-10-14 12:28:45,141 - root - INFO - Component Sort is parsed
2024-10-14 12:28:45,141 - root - INFO - Component Sort 1 is parsed
2024-10-14 12:28:45,141 - root - INFO - Resultant component map {'Merge Join': ['Microsoft.MergeJoin', True, 'StoredProcedure2'], 'OLE DB Destination': ['Microsoft.OLEDBDestination', True], 'Products': ['Microsoft.OLEDBSource', True, 'AProduct', 'CopyActivity3'], 'Purchases': ['Microsoft.OLEDBSource', True, 'APurchases', 'CopyActivity4'], 'Sort': ['Microsoft.Sort', True, 'APurchases', 'CopyActivity4'], 'Sort 1': ['Microsoft.Sort', True, 'AProduct', 'CopyActivity3']}
2024-10-14 12:28:45,141 - root - INFO - Executables last activitites map: {'Data Flow Task1': ['StoredProcedure1'], 'Data Flow Task2': ['StoredProcedure2']}
2024-10-14 12:28:45,141 - root - INFO - Added pipeline name to pipeline.json
2024-10-14 12:28:45,152 - root - INFO - Encoded pipeline.json into base64 format
2024-10-14 12:28:45,153 - root - INFO - pipeline.json cleaned up
2024-10-14 12:28:45,158 - root - INFO - payload created for API request
2024-10-14 12:28:46,310 - root - INFO - payload.json cleaned up
2024-10-14 12:28:46,310 - root - INFO - Failed to create pipeline
{'requestId': 'a1c415db-60aa-4aff-9cfb-49f92a717d93', 'errorCode': 'ItemDisplayNameAlreadyInUse', 'message': "Requested '2-dataflows' is already in use"}
2024-10-14 12:28:46,310 - root - ERROR - Function create_pipeline(), Error creating the pipeline
2024-10-14 12:28:46,316 - root - ERROR - Failed to migrate: Failed to create pipeline. Status code: 400, Response: {'requestId': 'a1c415db-60aa-4aff-9cfb-49f92a717d93', 'errorCode': 'ItemDisplayNameAlreadyInUse', 'message': "Requested '2-dataflows' is already in use"}
2024-10-14 12:28:46,497 - root - INFO - Table 'Source_EmployeeContact' dropped successfully.
2024-10-14 12:28:46,597 - root - INFO - Table 'Source_EmployeeInfo' dropped successfully.
2024-10-14 12:28:46,686 - root - INFO - Table 'AProduct' dropped successfully.
2024-10-14 12:28:46,783 - root - INFO - Table 'APurchases' dropped successfully.
2024-10-14 12:28:46,829 - root - INFO - Procedure 'Lookup_Source_Employee' dropped successfully.
2024-10-14 12:28:46,867 - root - INFO - Procedure 'Merge_APurchasesFlow2' dropped successfully.
2024-10-14 12:28:46,948 - root - INFO - pipeline.json cleaned up
2024-10-14 12:28:46,956 - root - INFO - payload.json cleaned up
2024-10-14 12:28:46,956 - werkzeug - INFO - 127.0.0.1 - - [14/Oct/2024 12:28:46] "[35m[1mPOST /migrate HTTP/1.1[0m" 500 -
2024-10-14 12:31:14,587 - root - INFO - File received is Multiple-Dataflows.dtsx
2024-10-14 12:31:14,587 - root - INFO - File saved in temp library
2024-10-14 12:31:14,587 - root - INFO - Input details received
2024-10-14 12:31:33,006 - root - INFO - Access token acquired
2024-10-14 12:31:34,544 - root - INFO - Received the workspace id 87a9f325-0a3f-40e3-954d-bdc5e25bd8b9
2024-10-14 12:31:36,160 - root - INFO - Received the lakehouse id '0717e896-3f43-4721-af39-5c756634a689'
2024-10-14 12:31:37,264 - root - INFO - Received the warehouse id 84821c70-f689-4f53-91b8-2b5ad07ea1cd
2024-10-14 12:31:37,272 - root - INFO - Executables: ['Data Flow Task1', 'Data Flow Task2']
2024-10-14 12:31:37,280 - root - INFO - Executable Data Flow Task1 is a Microsoft.Pipeline
2024-10-14 12:31:37,280 - root - INFO - Parsing the executable Data Flow Task1
2024-10-14 12:31:37,282 - root - INFO - Source_EmployeeContact columns : ['EmployeeID', 'PhoneNumber', 'Email'] dataypes: ['i4', 'wstr', 'wstr']
2024-10-14 12:31:37,282 - root - INFO - Component map : {'Lookup': ['Microsoft.Lookup', False], 'OLE DB Destination': ['Microsoft.OLEDBDestination', False], 'OLE DB Source': ['Microsoft.OLEDBSource', False, 'Source_EmployeeContact']}
2024-10-14 12:31:37,282 - root - INFO - Execution Flow Map: {'Lookup': [['OLE DB Destination', 'Microsoft.OLEDBDestination']], 'OLE DB Destination': [], 'OLE DB Source': [['Lookup', 'Microsoft.Lookup']]}
2024-10-14 12:31:37,286 - root - INFO - Dependency map: {'Lookup': ['OLE DB Source'], 'OLE DB Destination': ['Lookup'], 'OLE DB Source': []}
2024-10-14 12:31:37,286 - root - INFO - Source_EmployeeContact columns : ['EmployeeID', 'PhoneNumber', 'Email'] dataypes: ['i4', 'wstr', 'wstr']
2024-10-14 12:31:37,286 - root - INFO - create table statement designed for table name Source_EmployeeContact
CREATE TABLE Source_EmployeeContact (EmployeeID INT, PhoneNumber VARCHAR(100), Email VARCHAR(100));
2024-10-14 12:31:39,922 - root - INFO - Table/Procedure created successfully.
2024-10-14 12:31:39,963 - root - INFO - JSON for CopyActivity1 created and added to pipeline.json
2024-10-14 12:31:39,963 - root - INFO - Input columns for Lookup are ['EmployeeID', 'PhoneNumber', 'Email']
2024-10-14 12:31:39,963 - root - INFO - Referred columns in Lookup are ['FirstName', 'LastName', 'Department']
2024-10-14 12:31:39,971 - root - INFO - create table statement designed for table name Source_EmployeeInfo
CREATE TABLE Source_EmployeeInfo (EmployeeID INT, FirstName VARCHAR(100), LastName VARCHAR(100), Department VARCHAR(100));
2024-10-14 12:31:40,334 - root - INFO - Table/Procedure created successfully.
2024-10-14 12:31:40,368 - root - INFO - JSON for CopyActivity2 created and added to pipeline.json
2024-10-14 12:31:40,487 - root - INFO - Table/Procedure created successfully.
2024-10-14 12:31:40,522 - root - INFO - Procedure: 
                        CREATE PROCEDURE Lookup_Source_Employee AS
                        BEGIN
                            IF OBJECT_ID('Source_Employee', 'U') IS NOT NULL
                            BEGIN
                                DROP TABLE Source_Employee;
                            END
                            CREATE TABLE Source_Employee AS
                            SELECT t1.EmployeeID, t1.PhoneNumber, t1.Email, t2.FirstName AS FirstName, t2.LastName AS LastName, t2.Department AS Department FROM dbo.Source_EmployeeContact AS t1 JOIN dbo.Source_EmployeeInfo AS t2 ON t1.EmployeeID = t2.EmployeeID
                        END;
                    
2024-10-14 12:31:40,535 - root - INFO - JSON for StoredProcedure1 created successfully.
2024-10-14 12:31:40,535 - root - INFO - Component OLE DB Source is parsed
2024-10-14 12:31:40,535 - root - INFO - Component Lookup is parsed
2024-10-14 12:31:40,540 - root - INFO - Component OLE DB Destination is parsed
2024-10-14 12:31:40,540 - root - INFO - Component OLE DB Source is parsed
2024-10-14 12:31:40,540 - root - INFO - Resultant component map {'Lookup': ['Microsoft.Lookup', True, 'StoredProcedure1'], 'OLE DB Destination': ['Microsoft.OLEDBDestination', True], 'OLE DB Source': ['Microsoft.OLEDBSource', True, 'Source_EmployeeContact', 'CopyActivity1']}
2024-10-14 12:31:40,540 - root - INFO - Executables last activitites map: {'Data Flow Task1': ['StoredProcedure1']}
2024-10-14 12:31:40,540 - root - INFO - Executable Data Flow Task2 is a Microsoft.Pipeline
2024-10-14 12:31:40,540 - root - INFO - Parsing the executable Data Flow Task2
2024-10-14 12:31:40,548 - root - INFO - AProduct columns : ['Product_ID', 'Product_Name', 'Category'] dataypes: ['i4', 'str', 'str']
2024-10-14 12:31:40,548 - root - INFO - APurchases columns : ['Purchase_ID', 'Product_ID', 'Quantity_Sold', 'Amount'] dataypes: ['i4', 'i4', 'i4', 'numeric']
2024-10-14 12:31:40,551 - root - INFO - Component map : {'Merge Join': ['Microsoft.MergeJoin', False], 'OLE DB Destination': ['Microsoft.OLEDBDestination', False], 'Products': ['Microsoft.OLEDBSource', False, 'AProduct'], 'Purchases': ['Microsoft.OLEDBSource', False, 'APurchases'], 'Sort': ['Microsoft.Sort', False], 'Sort 1': ['Microsoft.Sort', False]}
2024-10-14 12:31:40,555 - root - INFO - Execution Flow Map: {'Merge Join': [['OLE DB Destination', 'Microsoft.OLEDBDestination']], 'OLE DB Destination': [], 'Products': [['Sort 1', 'Microsoft.Sort']], 'Purchases': [['Sort', 'Microsoft.Sort']], 'Sort': [['Merge Join', 'Microsoft.MergeJoin']], 'Sort 1': [['Merge Join', 'Microsoft.MergeJoin']]}
2024-10-14 12:31:40,556 - root - INFO - Dependency map: {'Merge Join': ['Sort', 'Sort 1'], 'OLE DB Destination': ['Merge Join'], 'Products': [], 'Purchases': [], 'Sort': ['Purchases'], 'Sort 1': ['Products']}
2024-10-14 12:31:40,558 - root - INFO - AProduct columns : ['Product_ID', 'Product_Name', 'Category'] dataypes: ['i4', 'str', 'str']
2024-10-14 12:31:40,558 - root - INFO - create table statement designed for table name AProduct
CREATE TABLE AProduct (Product_ID INT, Product_Name VARCHAR(100), Category VARCHAR(100));
2024-10-14 12:31:40,949 - root - INFO - Table/Procedure created successfully.
2024-10-14 12:31:40,995 - root - INFO - JSON for CopyActivity3 created and added to pipeline.json
2024-10-14 12:31:40,997 - root - INFO - APurchases columns : ['Purchase_ID', 'Product_ID', 'Quantity_Sold', 'Amount'] dataypes: ['i4', 'i4', 'i4', 'numeric']
2024-10-14 12:31:41,000 - root - INFO - create table statement designed for table name APurchases
CREATE TABLE APurchases (Purchase_ID INT, Product_ID INT, Quantity_Sold INT, Amount DECIMAL(38,2));
2024-10-14 12:31:41,342 - root - INFO - Table/Procedure created successfully.
2024-10-14 12:31:41,381 - root - INFO - JSON for CopyActivity4 created and added to pipeline.json
2024-10-14 12:31:41,384 - root - INFO - Left Input columns for Merge Join are ['Product_ID', 'Purchase_ID', 'Quantity_Sold', 'Amount'] sorted as {1: 'Product_ID'}
2024-10-14 12:31:41,384 - root - INFO - Right Input columns for Merge Join are ['Product_ID', 'Product_Name', 'Category'] sorted as {1: 'Product_ID'}
2024-10-14 12:31:41,384 - root - INFO - Output columns from Merge Join are ['Purchase_ID', 'Product_ID', 'Product_Name', 'Category', 'Quantity_Sold', 'Amount']
2024-10-14 12:31:41,384 - root - INFO - Procedure: 
                        CREATE PROCEDURE Merge_APurchasesFlow2 AS
                        BEGIN
                            IF OBJECT_ID('APurchasesFlow2', 'U') IS NOT NULL
                            BEGIN
                                DROP TABLE APurchasesFlow2;
                            END
                            CREATE TABLE APurchasesFlow2 AS
                            SELECT t1.Purchase_ID AS Purchase_ID, t1.Product_ID AS Product_ID, t2.Product_Name AS Product_Name, t2.Category AS Category, t1.Quantity_Sold AS Quantity_Sold, t1.Amount AS Amount FROM dbo.APurchases AS t1 INNER JOIN dbo.AProduct AS t2 ON t1.Product_ID = t2.Product_ID;
                        END;
                    
2024-10-14 12:31:41,495 - root - INFO - Table/Procedure created successfully.
2024-10-14 12:31:41,538 - root - INFO - JSON for StoredProcedure2 created successfully.
2024-10-14 12:31:41,538 - root - INFO - Component Products is parsed
2024-10-14 12:31:41,538 - root - INFO - Component Purchases is parsed
2024-10-14 12:31:41,538 - root - INFO - Component Sort is parsed
2024-10-14 12:31:41,543 - root - INFO - Component Sort 1 is parsed
2024-10-14 12:31:41,543 - root - INFO - Component Merge Join is parsed
2024-10-14 12:31:41,546 - root - INFO - Component OLE DB Destination is parsed
2024-10-14 12:31:41,546 - root - INFO - Component Products is parsed
2024-10-14 12:31:41,547 - root - INFO - Component Purchases is parsed
2024-10-14 12:31:41,547 - root - INFO - Component Sort is parsed
2024-10-14 12:31:41,547 - root - INFO - Component Sort 1 is parsed
2024-10-14 12:31:41,547 - root - INFO - Resultant component map {'Merge Join': ['Microsoft.MergeJoin', True, 'StoredProcedure2'], 'OLE DB Destination': ['Microsoft.OLEDBDestination', True], 'Products': ['Microsoft.OLEDBSource', True, 'AProduct', 'CopyActivity3'], 'Purchases': ['Microsoft.OLEDBSource', True, 'APurchases', 'CopyActivity4'], 'Sort': ['Microsoft.Sort', True, 'APurchases', 'CopyActivity4'], 'Sort 1': ['Microsoft.Sort', True, 'AProduct', 'CopyActivity3']}
2024-10-14 12:31:41,553 - root - INFO - Executables last activitites map: {'Data Flow Task1': ['StoredProcedure1'], 'Data Flow Task2': ['StoredProcedure2']}
2024-10-14 12:31:41,554 - root - INFO - Added pipeline name to pipeline.json
2024-10-14 12:31:41,561 - root - INFO - Encoded pipeline.json into base64 format
2024-10-14 12:31:41,563 - root - INFO - pipeline.json cleaned up
2024-10-14 12:31:41,567 - root - INFO - payload created for API request
2024-10-14 12:31:46,320 - root - INFO - payload.json cleaned up
2024-10-14 12:31:46,320 - root - INFO - Pipeline created successfully
{'id': '0e516416-e112-4a14-9d7f-c4586ee7e798', 'type': 'DataPipeline', 'displayName': 'multi-dataflows', 'description': '', 'workspaceId': '87a9f325-0a3f-40e3-954d-bdc5e25bd8b9'}
2024-10-14 12:31:46,336 - werkzeug - INFO - 127.0.0.1 - - [14/Oct/2024 12:31:46] "POST /migrate HTTP/1.1" 200 -
